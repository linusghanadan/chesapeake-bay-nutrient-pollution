"0","# Compute phosphorus monthly moving average, and store as tsibble"
"0","phos_monthly_avgs_ts <- phos_data %>% "
"0","  mutate(yr_mo = tsibble::yearmonth(SampleDate)) %>%"
"0","  group_by(yr_mo) %>%"
"0","  summarize(monthly_avg = mean(MeasureValue, na.rm = TRUE)) %>% "
"0","  tsibble::as_tsibble()"
"0",""
"0","# Create data frame version, and convert year-months to Date class (helpful for plotting)"
"0","phos_monthly_avgs_df <- as.data.frame(phos_monthly_avgs_ts)"
"0","phos_monthly_avgs_df$yr_mo <- as.Date(phos_monthly_avgs_ts$yr_mo, format = ""%Y-%m"")"
"0",""
"0","# Plot monthly average phosphorus concentration as a function of year-month"
"0","phos_monthly_avgs_df %>%"
"0","  ggplot(aes(x = yr_mo, y = monthly_avg)) +"
"0","  stat_summary(geom = 'line', fun = 'mean') +"
"0","  labs(x = 'Year-Month', y = 'Monthly Mean Concentration (mg/L)', title = ""Phosphorus in Chesapeake Bay (2010-2019)"") +"
"0","  scale_x_date(date_breaks = ""1 year"", date_minor_breaks = ""6 months"", date_labels = ""%Y-%m"") +"
"0","  theme_bw() +"
"0","  theme(plot.title = element_text(hjust = 0.5))"
